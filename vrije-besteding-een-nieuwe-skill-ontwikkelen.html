<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>6 Vrije besteding: een nieuwe skill ontwikkelen | Mijn Data Sciences portfolio</title>
  <meta name="description" content="6 Vrije besteding: een nieuwe skill ontwikkelen | Mijn Data Sciences portfolio" />
  <meta name="generator" content="bookdown 0.26 and GitBook 2.6.7" />

  <meta property="og:title" content="6 Vrije besteding: een nieuwe skill ontwikkelen | Mijn Data Sciences portfolio" />
  <meta property="og:type" content="book" />
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="6 Vrije besteding: een nieuwe skill ontwikkelen | Mijn Data Sciences portfolio" />
  
  
  




  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="vaardigheid-4-opmaken-met-rmarkdown-en-html-syntax.html"/>
<link rel="next" href="vaardigheid-5-correct-refereren-m.b.v.-een-reference-manager.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="portfolio_style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Over mij</a></li>
<li class="chapter" data-level="2" data-path="vaardigheid-1-semi-reproduceerbare-data-analyseren.html"><a href="vaardigheid-1-semi-reproduceerbare-data-analyseren.html"><i class="fa fa-check"></i><b>2</b> Vaardigheid 1: Semi-reproduceerbare data analyseren</a>
<ul>
<li class="chapter" data-level="2.1" data-path="vaardigheid-1-semi-reproduceerbare-data-analyseren.html"><a href="vaardigheid-1-semi-reproduceerbare-data-analyseren.html#c.-elegans-kweekplaat-experiment"><i class="fa fa-check"></i><b>2.1</b> <em>C. elegans</em> kweekplaat experiment</a></li>
<li class="chapter" data-level="2.2" data-path="vaardigheid-1-semi-reproduceerbare-data-analyseren.html"><a href="vaardigheid-1-semi-reproduceerbare-data-analyseren.html#normalisatie-met-het-drc-package"><i class="fa fa-check"></i><b>2.2</b> Normalisatie met het {drc} package</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="vaardigheid-2-een-open-source-analyse-reproduceren.html"><a href="vaardigheid-2-een-open-source-analyse-reproduceren.html"><i class="fa fa-check"></i><b>3</b> Vaardigheid 2: Een <em>Open Source</em> analyse reproduceren</a>
<ul>
<li class="chapter" data-level="3.1" data-path="vaardigheid-2-een-open-source-analyse-reproduceren.html"><a href="vaardigheid-2-een-open-source-analyse-reproduceren.html#ripeta-criteria"><i class="fa fa-check"></i><b>3.1</b> Ripeta criteria</a></li>
<li class="chapter" data-level="3.2" data-path="vaardigheid-2-een-open-source-analyse-reproduceren.html"><a href="vaardigheid-2-een-open-source-analyse-reproduceren.html#analyse-reproduceren"><i class="fa fa-check"></i><b>3.2</b> Analyse reproduceren</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="vaardigheid-3-folder-structuur-gebruiken-volgens-de-guerilla-principles.html"><a href="vaardigheid-3-folder-structuur-gebruiken-volgens-de-guerilla-principles.html"><i class="fa fa-check"></i><b>4</b> Vaardigheid 3: Folder structuur gebruiken volgens de <em>Guerilla Principles</em></a></li>
<li class="chapter" data-level="5" data-path="vaardigheid-4-opmaken-met-rmarkdown-en-html-syntax.html"><a href="vaardigheid-4-opmaken-met-rmarkdown-en-html-syntax.html"><i class="fa fa-check"></i><b>5</b> Vaardigheid 4: Opmaken met RMarkdown en HTML syntax</a></li>
<li class="chapter" data-level="6" data-path="vrije-besteding-een-nieuwe-skill-ontwikkelen.html"><a href="vrije-besteding-een-nieuwe-skill-ontwikkelen.html"><i class="fa fa-check"></i><b>6</b> Vrije besteding: een nieuwe <em>skill</em> ontwikkelen</a>
<ul>
<li class="chapter" data-level="6.1" data-path="vrije-besteding-een-nieuwe-skill-ontwikkelen.html"><a href="vrije-besteding-een-nieuwe-skill-ontwikkelen.html#introductie"><i class="fa fa-check"></i><b>6.1</b> Introductie</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="vrije-besteding-een-nieuwe-skill-ontwikkelen.html"><a href="vrije-besteding-een-nieuwe-skill-ontwikkelen.html#plan-van-aanpak"><i class="fa fa-check"></i><b>6.1.1</b> Plan van Aanpak</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="vrije-besteding-een-nieuwe-skill-ontwikkelen.html"><a href="vrije-besteding-een-nieuwe-skill-ontwikkelen.html#deel-1-oefenen-met-de-vignette-lcms-data-preprocessing-and-analysis-with-xcms"><i class="fa fa-check"></i><b>6.2</b> Deel 1: Oefenen met de vignette ‘LCMS data preprocessing and analysis with xcms’</a></li>
<li class="chapter" data-level="6.3" data-path="vrije-besteding-een-nieuwe-skill-ontwikkelen.html"><a href="vrije-besteding-een-nieuwe-skill-ontwikkelen.html#deel-2-xcms-gebruiken-voor-een-eigen-analyse-van-de-faahko-monsters"><i class="fa fa-check"></i><b>6.3</b> Deel 2: xcms gebruiken voor een eigen analyse van de {faahKO} monsters</a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="vrije-besteding-een-nieuwe-skill-ontwikkelen.html"><a href="vrije-besteding-een-nieuwe-skill-ontwikkelen.html#data-import"><i class="fa fa-check"></i><b>6.3.1</b> 1) Data import</a></li>
<li class="chapter" data-level="6.3.2" data-path="vrije-besteding-een-nieuwe-skill-ontwikkelen.html"><a href="vrije-besteding-een-nieuwe-skill-ontwikkelen.html#data-inspectie"><i class="fa fa-check"></i><b>6.3.2</b> 2) Data inspectie</a></li>
<li class="chapter" data-level="6.3.3" data-path="vrije-besteding-een-nieuwe-skill-ontwikkelen.html"><a href="vrije-besteding-een-nieuwe-skill-ontwikkelen.html#piekdetectie"><i class="fa fa-check"></i><b>6.3.3</b> 3) Piekdetectie</a></li>
<li class="chapter" data-level="6.3.4" data-path="vrije-besteding-een-nieuwe-skill-ontwikkelen.html"><a href="vrije-besteding-een-nieuwe-skill-ontwikkelen.html#alignment"><i class="fa fa-check"></i><b>6.3.4</b> 4) <em>Alignment</em></a></li>
<li class="chapter" data-level="6.3.5" data-path="vrije-besteding-een-nieuwe-skill-ontwikkelen.html"><a href="vrije-besteding-een-nieuwe-skill-ontwikkelen.html#correspondence"><i class="fa fa-check"></i><b>6.3.5</b> 5) <em>Correspondence</em></a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="vrije-besteding-een-nieuwe-skill-ontwikkelen.html"><a href="vrije-besteding-een-nieuwe-skill-ontwikkelen.html#afronding"><i class="fa fa-check"></i><b>6.4</b> Afronding</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="vaardigheid-5-correct-refereren-m.b.v.-een-reference-manager.html"><a href="vaardigheid-5-correct-refereren-m.b.v.-een-reference-manager.html"><i class="fa fa-check"></i><b>7</b> Vaardigheid 5: Correct refereren m.b.v. een <em>reference manager</em></a>
<ul>
<li class="chapter" data-level="7.1" data-path="vaardigheid-5-correct-refereren-m.b.v.-een-reference-manager.html"><a href="vaardigheid-5-correct-refereren-m.b.v.-een-reference-manager.html#dsfb2-2022-project-regenwormen-introductie"><i class="fa fa-check"></i><b>7.1</b> DSFB2 2022 Project Regenwormen: Introductie</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="vaardigheid-6-werken-met-relational-databases.html"><a href="vaardigheid-6-werken-met-relational-databases.html"><i class="fa fa-check"></i><b>8</b> Vaardigheid 6: Werken met <em>relational databases</em></a>
<ul>
<li class="chapter" data-level="8.1" data-path="vaardigheid-6-werken-met-relational-databases.html"><a href="vaardigheid-6-werken-met-relational-databases.html#samenvoegen-van-virus-activiteit-dummy-data-met-gapminder-dataset"><i class="fa fa-check"></i><b>8.1</b> Samenvoegen van virus-activiteit dummy data met gapminder dataset</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="vaardigheid-7-een-r-package-maken.html"><a href="vaardigheid-7-een-r-package-maken.html"><i class="fa fa-check"></i><b>9</b> Vaardigheid 7: Een R <em>package</em> maken</a></li>
<li class="chapter" data-level="10" data-path="vaardigheid-8-rmarkdowns-parameteriseren.html"><a href="vaardigheid-8-rmarkdowns-parameteriseren.html"><i class="fa fa-check"></i><b>10</b> Vaardigheid 8: RMarkdowns parameteriseren</a>
<ul>
<li class="chapter" data-level="10.1" data-path="vaardigheid-8-rmarkdowns-parameteriseren.html"><a href="vaardigheid-8-rmarkdowns-parameteriseren.html#ecdc-data-nieuwgemelde-covid-19-gevallen-en--doden"><i class="fa fa-check"></i><b>10.1</b> ECDC data nieuwgemelde COVID-19-gevallen en -doden</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="referenties.html"><a href="referenties.html"><i class="fa fa-check"></i><b>11</b> Referenties</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Mijn Data Sciences portfolio</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<link href="portfolio_style.css" rel="stylesheet">
<div class="hero-image-container">
  <img class= "hero-image" src="https://www.economist.com/img/b/1096/616/90/sites/default/files/20200222_STP002.jpg">
</div>
<div id="vrije-besteding-een-nieuwe-skill-ontwikkelen" class="section level1 hasAnchor" number="6">
<h1><span class="header-section-number">6</span> Vrije besteding: een nieuwe <em>skill</em> ontwikkelen<a href="vrije-besteding-een-nieuwe-skill-ontwikkelen.html#vrije-besteding-een-nieuwe-skill-ontwikkelen" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="introductie" class="section level2 hasAnchor" number="6.1">
<h2><span class="header-section-number">6.1</span> Introductie<a href="vrije-besteding-een-nieuwe-skill-ontwikkelen.html#introductie" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Tijdens de DSFB2 <em>Workflows</em> lessen heb ik 32 uur vrij te besteden gekregen om te werken aan een nieuwe <em>Data Science skill</em>. Deze <em>skill</em> heb ik gekozen door mijzelf af te vragen waar ik over twee jaar wil zijn. Ik zie mijzelf dan als biomedisch analist een bijdrage leveren aan onderzoek naar de ontwikkeling, bestrijding en genezing van ziekten. Specifiek zou ik graag onderzoek doen naar kanker of hersenziekten met celkweek, gentherapie en eiwit analyse technieken. Daarbij gebruik ik de vaardigheden die ik heb geleerd tijdens de <em>Data Sciences for Biology</em> minor om mijn onderzoeksresultaten te analyseren en presenteren. Eiwit analyse technieken waarin ik specifiek geïnteresseerd ben, zijn <em>High-Performance Liquid Chromatography</em> (HPLC) en massaspectrometrie (MS). Uiteindelijk wil ik doorstuderen tot moleculair bioloog en grootschalige onderzoeken opzetten.</p>
<p>Tijdens mijn BMR specialisatie projecticum heb ik gewerkt met een HPLC. De UV-detectie resultaten kwamen op de computer binnen via de software Clarity Lite, waarna handmatig data van interesse is gekopieerd naar een Excel bestand. Van deze data zijn tabellen gemaakt in PowerPoint en grafieken in Excel. Statistische tests zijn uitgevoerd in SPSS. Om het aantal handmatige stappen en de vatbaarheid voor fouten van deze analyse te verminderen, ben ik gaan onderzoeken of ik de ruwe Clarity Lite data kan exporteren en aan een R <em>package</em> kan ‘voeren’ voor een volledige data analyse in RStudio. Al vrij snel bleek ik geen R <em>package</em> te kunnen vinden voor de analyse van (HP)LC data. Ik ben wel een handvol <em>packages</em> tegengekomen voor analyses van LC-MS data <strong>(zie tabel 6.1)</strong>. Vloeistofchromatografie en massaspectrometrie zijn tegenwoordig vrijwel niet meer los van elkaar te denken. Daarnaast wil ik üperhaupt meer ervaring opdoen met massaspectrometrie. Hierom heb ik ervoor gekozen om mij voor 32 uur te richten op het analyseren van LC-MS data met R als nieuwe <em>skill</em>.</p>
<table class="table table-striped" style="width: auto !important; border-bottom: 0;">
<caption>
<span id="tab:unnamed-chunk-16">Table 6.1: </span><strong>Gevonden R packages voor LC-MS of GC-MS data analyse</strong>
</caption>
<thead>
<tr>
<th style="text-align:left;">
Algorithm
</th>
<th style="text-align:left;">
Designed for
</th>
<th style="text-align:left;">
Used Dimensions
</th>
<th style="text-align:left;">
Environment
</th>
<th style="text-align:left;">
Visual tools
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;font-weight: bold;color: green !important;">
amsrpm
</td>
<td style="text-align:left;color: green !important;">
LC-MS
</td>
<td style="text-align:left;color: green !important;">
RT, I, m/z
</td>
<td style="text-align:left;color: green !important;">
R
</td>
<td style="text-align:left;color: green !important;">
No
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;">
msInspect/AMT
</td>
<td style="text-align:left;">
LC-MS/MS
</td>
<td style="text-align:left;">
RT, I, m/z
</td>
<td style="text-align:left;">
Java, R
</td>
<td style="text-align:left;">
No
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;">
PETAL
</td>
<td style="text-align:left;">
LC-MS
</td>
<td style="text-align:left;">
RT, m/z
</td>
<td style="text-align:left;">
R
</td>
<td style="text-align:left;">
No
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;">
Podwojski
</td>
<td style="text-align:left;">
LC-MS
</td>
<td style="text-align:left;">
RT, I, m/z
</td>
<td style="text-align:left;">
R
</td>
<td style="text-align:left;">
No
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;color: green !important;">
ptw
</td>
<td style="text-align:left;color: green !important;">
LC-MS
</td>
<td style="text-align:left;color: green !important;">
I, RT
</td>
<td style="text-align:left;color: green !important;">
R
</td>
<td style="text-align:left;color: green !important;">
No
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;color: green !important;">
xcms
</td>
<td style="text-align:left;color: green !important;">
LC-MS
</td>
<td style="text-align:left;color: green !important;">
RT, I, m/z
</td>
<td style="text-align:left;color: green !important;">
R
</td>
<td style="text-align:left;color: green !important;">
Yes
</td>
</tr>
</tbody>
<tfoot>
<tr>
<td style="padding: 0; " colspan="100%">
<span style="font-style: italic;">Note: </span>
</td>
</tr>
<tr>
<td style="padding: 0; " colspan="100%">
<sup></sup> Deze tabel is een onderdeel van de tabel ‘<em>S1. Summary of published algorithms implemented … datasets.</em>’ uit <a href="https://journals.plos.org/plosone/article?id=10.1371/journal.pone.0198311">M. Ottensmann et al., 2018</a>. De <em>packages</em> waar ik me verder in heb verdiept, zijn groen gekleurd.
</td>
</tr>
</tfoot>
</table>
<div id="plan-van-aanpak" class="section level3 hasAnchor" number="6.1.1">
<h3><span class="header-section-number">6.1.1</span> Plan van Aanpak<a href="vrije-besteding-een-nieuwe-skill-ontwikkelen.html#plan-van-aanpak" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Ik heb een kort plan opgesteld waarmee ik het leren van deze nieuwe <em>skill</em> ga aanpakken. Eén week voordat het portfolio moet worden ingeleverd, ga ik echt van start.</p>
<table class="table table-striped" style="width: auto !important; border-bottom: 0;">
<caption>
<span id="tab:unnamed-chunk-17">Table 6.2: </span><strong>Urenplanning</strong>
</caption>
<thead>
<tr>
<th style="text-align:right;">
Stap
</th>
<th style="text-align:left;">
Wat
</th>
<th style="text-align:left;">
Schatting tijdsbelasting
</th>
<th style="text-align:left;">
Werkelijke tijdsbelasting
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;font-weight: bold;">
1
</td>
<td style="text-align:left;">
Oriënteren op de R <em>packages</em> die beschikbaar zijn voor LC-MS data analyse.
</td>
<td style="text-align:left;">
2 uur
</td>
<td style="text-align:left;color: red !important;">
~ 1,5 uur
</td>
</tr>
<tr>
<td style="text-align:right;font-weight: bold;">
2
</td>
<td style="text-align:left;">
Twee á drie <em>packages</em> kiezen en hier verder in verdiepen.**
</td>
<td style="text-align:left;">
2,5 uur
</td>
<td style="text-align:left;color: red !important;">
~ 1,5 uur
</td>
</tr>
<tr>
<td style="text-align:right;font-weight: bold;">
3
</td>
<td style="text-align:left;">
De <em>packages</em> proberen te installeren.
</td>
<td style="text-align:left;">
2 uur
</td>
<td style="text-align:left;color: red !important;">
2 uur
</td>
</tr>
<tr>
<td style="text-align:right;font-weight: bold;">
4
</td>
<td style="text-align:left;">
Eén <em>package</em> kiezen en een tutorial o.i.d. over deze <em>package</em> volgen.
</td>
<td style="text-align:left;">
~ 8 uur
</td>
<td style="text-align:left;color: red !important;">
11 uur
</td>
</tr>
<tr>
<td style="text-align:right;font-weight: bold;">
5
</td>
<td style="text-align:left;">
Het <em>package</em> zelf proberen toe te passen op andere data.
</td>
<td style="text-align:left;">
~ 10 uur
</td>
<td style="text-align:left;color: red !important;">
12,5 uur
</td>
</tr>
<tr>
<td style="text-align:right;font-weight: bold;">
6
</td>
<td style="text-align:left;">
Eigen code duidelijk uitschrijven in portfolio.
</td>
<td style="text-align:left;">
max. 4 uur
</td>
<td style="text-align:left;color: red !important;">
~ 5 uur
</td>
</tr>
</tbody>
<tfoot>
<tr>
<td style="padding: 0; " colspan="100%">
<span style="font-style: italic;">Note: </span>
</td>
</tr>
<tr>
<td style="padding: 0; " colspan="100%">
<sup></sup> *Ik maak een afspraak met een docent voor gebruik van de HPLC computer op HL7.
</td>
</tr>
<tr>
<td style="padding: 0; " colspan="100%">
<sup></sup> **Criteria: er moet tenminste één uitgebreide tutorial o.i.d. met bijbehorende dataset beschikbaar zijn voor het <em>package</em>, evenals nieuwe data om zelf een code voor te schrijven.
</td>
</tr>
</tfoot>
</table>
<p>Indien er tijd over is, probeer ik een (korte) tutorial te vinden van een ander <em>package</em> voor LC-MS analyse. Mocht het nou allemaal nergens op uitdraaien, is mijn plan B om de analyse van mijn BMR projecticum volledig te automatiseren in R. Dit is dan geen nieuwe <em>skill</em>, maar wel een volledig zelf bedachte analyse en zelfgeschreven code.</p>
<p>Het is me niet gelukt om het {amsrpm} <em>package</em>, beschikbaar als <a href="https://www.jstatsoft.org/article/view/v018i04">amsrpm.tar.gz</a>, te installeren. Van het {ptw} <em>package</em> is een publieke <em><a href="https://github.com/rwehrens/ptw">repository</a></em> met demo’s beschikbaar, maar de meeste informatie kon ik vinden over het {xcms} <em>package</em>. Er bestaat een publieke <em><a href="https://github.com/sneumann/xcms">repository</a></em> met verschillende vignettes waarin het <em>package</em> uitgebreid wordt gedemonstreerd. Belangrijk is ook dat de vignettes gebruik maken van ruwe data beschikbaar in andere ‘installeerbare’ <em>packages</em>, zoals {faahKO}. Na het kopiëren van de <em>repository</em> kon ik met ‘install()’ het <em>package</em> installeren. <em>Hiervoor moeten RStudio versie 4.2 en RTools versie 4.2 gebruikt worden. Buiten de repository om kunnen de functions uit dit package door een ieder geïnstalleerd worden met ‘devtools::install(“sneumann/xcms”)’</em>.</p>
</div>
</div>
<div id="deel-1-oefenen-met-de-vignette-lcms-data-preprocessing-and-analysis-with-xcms" class="section level2 hasAnchor" number="6.2">
<h2><span class="header-section-number">6.2</span> Deel 1: Oefenen met de vignette ‘LCMS data preprocessing and analysis with xcms’<a href="vrije-besteding-een-nieuwe-skill-ontwikkelen.html#deel-1-oefenen-met-de-vignette-lcms-data-preprocessing-and-analysis-with-xcms" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Het vignette ‘LCMS data preprocessing and analysis with xcms’, te vinden op <a href="https://bioconductor.org/packages/devel/bioc/vignettes/xcms/inst/doc/xcms.html#4_Chromatographic_peak_detection">BioConductor</a> of
onder ‘xcms/vignettes/xcms.Rmd’ in de <em>repository</em>, demonstreert hoe het {xcms} <em>package</em> gebruikt kan worden voor de import, inspectie, <em>preproccesing</em> en eigenlijke analyse van LC-MS data. Daarvoor maakt het gebruik van data uit een <a href="https://www.scripps.edu/cravatt/pdf/SaghatelianTrauger2004.pdf">studie</a> van Alan Saghatelian et al. uit 2004, beschikbaar als {faahKO} <em>package.</em> Deze onderzoekers zijn opzoek gegaan naar lipiden in het zoogdier brein die gereguleerd worden door het enzym <em>fatty acid amide hydrolase</em> (FAAH). Daartoe hebben ze met LC-MS het metaboloom in kaart gebracht van wildtype muizen en van <em>knock-out</em> muizen met een inactief FAAH gen <span class="citation">(Saghatelian et al. 2004)</span>. In het {faahKO} <em>package</em> is in NetCDF format de ruwe, <em>positive ion</em> en <em><a href="https://blog.acdlabs.com/elucidation/2008/03/what-is-the-dif.html">centroid mode</a></em> LC-MS data aanwezig van ruggengraatmonsters van wild-type (WT) en <em>knock-out</em> (KO) muizen. Het vignette beperkt de analyse tot zes WT muizen en zes KO muizen <span class="citation">(<span>“<span>LCMS</span> Data Preprocessing and Analysis with Xcms”</span> n.d.)</span>. Ik heb deze vignette grondig bestudeerd en de code gereproduceerd om te oefenen met het <em>package</em>, evenals om te checken of alle <em>functions</em> ook echt werken op mijn laptop.</p>
</div>
<div id="deel-2-xcms-gebruiken-voor-een-eigen-analyse-van-de-faahko-monsters" class="section level2 hasAnchor" number="6.3">
<h2><span class="header-section-number">6.3</span> Deel 2: xcms gebruiken voor een eigen analyse van de {faahKO} monsters<a href="vrije-besteding-een-nieuwe-skill-ontwikkelen.html#deel-2-xcms-gebruiken-voor-een-eigen-analyse-van-de-faahko-monsters" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>De nieuwgeleerde analyse heb ik toegepast op de monsters ko18, ko19, wt18 en wt19 uit het {faahKO} <em>package</em>. Deze monsters zijn niet meegenomen in de voorbeeld analyse. <strong>Ik begin met het inladen van een <em>workspace</em> met alle benodigde <em>objects</em>, omdat bepaalde <em>functions</em> tijdens het bouwen van dit Gitbook BiocParallel errors kunnen geven (bekend voor het {xcms} package). Deze <em>functions</em> zijn uitgezet met een ‘#’.</strong></p>
<div id="data-import" class="section level3 hasAnchor" number="6.3.1">
<h3><span class="header-section-number">6.3.1</span> 1) Data import<a href="vrije-besteding-een-nieuwe-skill-ontwikkelen.html#data-import" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="vrije-besteding-een-nieuwe-skill-ontwikkelen.html#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Installeer de volgende packages via CRAN of BioConductor en laad ze vervolgens met:</span></span>
<span id="cb21-2"><a href="vrije-besteding-een-nieuwe-skill-ontwikkelen.html#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(xcms)</span>
<span id="cb21-3"><a href="vrije-besteding-een-nieuwe-skill-ontwikkelen.html#cb21-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(faahKO)</span>
<span id="cb21-4"><a href="vrije-besteding-een-nieuwe-skill-ontwikkelen.html#cb21-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(RColorBrewer)</span>
<span id="cb21-5"><a href="vrije-besteding-een-nieuwe-skill-ontwikkelen.html#cb21-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(pander)</span>
<span id="cb21-6"><a href="vrije-besteding-een-nieuwe-skill-ontwikkelen.html#cb21-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(magrittr)</span>
<span id="cb21-7"><a href="vrije-besteding-een-nieuwe-skill-ontwikkelen.html#cb21-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(pheatmap)</span>
<span id="cb21-8"><a href="vrije-besteding-een-nieuwe-skill-ontwikkelen.html#cb21-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(SummarizedExperiment)</span>
<span id="cb21-9"><a href="vrije-besteding-een-nieuwe-skill-ontwikkelen.html#cb21-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-10"><a href="vrije-besteding-een-nieuwe-skill-ontwikkelen.html#cb21-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Laad workspace in omdat sommige functies nog wel eens een BiocParallel error gooien (bekend voor het {xcms} package):</span></span>
<span id="cb21-11"><a href="vrije-besteding-een-nieuwe-skill-ontwikkelen.html#cb21-11" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="st">&quot;workspace_eigen_code.RData&quot;</span>)</span>
<span id="cb21-12"><a href="vrije-besteding-een-nieuwe-skill-ontwikkelen.html#cb21-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-13"><a href="vrije-besteding-een-nieuwe-skill-ontwikkelen.html#cb21-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Maak een variabele met de paden naar de vier te analyseren files:</span></span>
<span id="cb21-14"><a href="vrije-besteding-een-nieuwe-skill-ontwikkelen.html#cb21-14" aria-hidden="true" tabindex="-1"></a>cdfs <span class="ot">&lt;-</span> <span class="fu">dir</span>(<span class="fu">system.file</span>(<span class="st">&quot;cdf&quot;</span>, <span class="at">package =</span> <span class="st">&quot;faahKO&quot;</span>), <span class="at">full.names =</span> <span class="cn">TRUE</span>, <span class="at">recursive =</span> <span class="cn">TRUE</span>)[<span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">9</span>, <span class="dv">10</span>)] <span class="do">## full.names en recursive voor paden i.p.v. bestandsnamen</span></span>
<span id="cb21-15"><a href="vrije-besteding-een-nieuwe-skill-ontwikkelen.html#cb21-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-16"><a href="vrije-besteding-een-nieuwe-skill-ontwikkelen.html#cb21-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Maak een phenodata dataframe:</span></span>
<span id="cb21-17"><a href="vrije-besteding-een-nieuwe-skill-ontwikkelen.html#cb21-17" aria-hidden="true" tabindex="-1"></a>pd <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">sample_name =</span> <span class="fu">sub</span>(<span class="fu">basename</span>(cdfs), <span class="at">pattern =</span> <span class="st">&quot;.CDF&quot;</span>, <span class="at">replacement =</span> <span class="st">&quot;&quot;</span>, <span class="at">fixed =</span> <span class="cn">TRUE</span>), <span class="at">sample_group =</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="st">&quot;KO&quot;</span>, <span class="dv">2</span>), <span class="fu">rep</span>(<span class="st">&quot;WT&quot;</span>, <span class="dv">2</span>)), <span class="at">stringsAsFactors =</span> <span class="cn">FALSE</span>) <span class="do">## sub() verwijdert .CDF uit naam, stringsAsFactors = FALSE geeft aan dat er geen factors gemaakt moeten worden van de character vectors</span></span>
<span id="cb21-18"><a href="vrije-besteding-een-nieuwe-skill-ontwikkelen.html#cb21-18" aria-hidden="true" tabindex="-1"></a>pd</span></code></pre></div>
<pre class="watch-out"><code>##   sample_name sample_group
## 1        ko18           KO
## 2        ko19           KO
## 3        wt18           WT
## 4        wt19           WT</code></pre>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="vrije-besteding-een-nieuwe-skill-ontwikkelen.html#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Laad de ruwe data:</span></span>
<span id="cb23-2"><a href="vrije-besteding-een-nieuwe-skill-ontwikkelen.html#cb23-2" aria-hidden="true" tabindex="-1"></a>raw_data <span class="ot">&lt;-</span> <span class="fu">readMSData</span>(<span class="at">files =</span> cdfs, <span class="at">pdata =</span> <span class="fu">new</span>(<span class="st">&quot;NAnnotatedDataFrame&quot;</span>, pd), <span class="at">mode =</span> <span class="st">&quot;onDisk&quot;</span>) <span class="do">## het pdata argument vraagt naar een AnnotatedDataFrame met metadata, onDisk zodat de ruwe data niet opgeslagen wordt in het geheugen (i.v.m. analyse snelheid)</span></span></code></pre></div>
<p>Het ‘phenodata’ <em>dataframe</em> functioneert als beschrijving van de experimentele opzet. <em>Voor een echt experiment wordt een tabel aangemaakt met een beschrijving van elk sample</em>. ‘raw_data’ is een ‘OnDiskMSnExp’ <em>object</em> dat per <a href="https://en.wikipedia.org/wiki/Mass_spectrum">spectrum</a> de gemeten retentie tijden, m/z ratio’s, intensiteiten en <em>total ion currents</em> bevat voor alle monsters <span class="citation">(<span>“<span>LCMS</span> Data Preprocessing and Analysis with Xcms”</span> n.d.)</span>.</p>
</div>
<div id="data-inspectie" class="section level3 hasAnchor" number="6.3.2">
<h3><span class="header-section-number">6.3.2</span> 2) Data inspectie<a href="vrije-besteding-een-nieuwe-skill-ontwikkelen.html#data-inspectie" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Ik begin met het plotten van de <em>base peak chromatograms</em> (BPCs) en <em>total ion chromatograms</em> (TICs) voor elk monster. Een BPC laat een piek zien gebaseerd op het ion met het sterkste signaal. Een TIC laat een piek als som van alle ionen zien. In de ‘chromatogram()’ <em>function</em> staat het ‘aggregationFun’ argument op ‘max’ of ‘sum’ voor respectievelijk een BPC of TIC <span class="citation">(<span>“<span>LCMS</span> Data Preprocessing and Analysis with Xcms”</span> n.d.)</span>.</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="vrije-besteding-een-nieuwe-skill-ontwikkelen.html#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Verkrijg BPCs:</span></span>
<span id="cb24-2"><a href="vrije-besteding-een-nieuwe-skill-ontwikkelen.html#cb24-2" aria-hidden="true" tabindex="-1"></a>bpis <span class="ot">&lt;-</span> <span class="fu">chromatogram</span>(raw_data, <span class="at">aggregationFun =</span> <span class="st">&quot;max&quot;</span>)  </span>
<span id="cb24-3"><a href="vrije-besteding-een-nieuwe-skill-ontwikkelen.html#cb24-3" aria-hidden="true" tabindex="-1"></a>group_colors <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;#60984EA3&quot;</span>, <span class="st">&quot;#604DAF4A&quot;</span>) <span class="do">## geef KO een paarse kleur en WT een groene kleur. Beide doorzichtig voor plots</span></span>
<span id="cb24-4"><a href="vrije-besteding-een-nieuwe-skill-ontwikkelen.html#cb24-4" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(group_colors) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;KO&quot;</span>, <span class="st">&quot;WT&quot;</span>)</span>
<span id="cb24-5"><a href="vrije-besteding-een-nieuwe-skill-ontwikkelen.html#cb24-5" aria-hidden="true" tabindex="-1"></a><span class="co"># bpis bevat de BPCs van alle monsters. Bekijk bijv. de retentie tijden per spectra van één monster met:</span></span>
<span id="cb24-6"><a href="vrije-besteding-een-nieuwe-skill-ontwikkelen.html#cb24-6" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(<span class="fu">rtime</span>(bpis[<span class="dv">1</span>, <span class="dv">1</span>]))</span></code></pre></div>
<pre class="watch-out"><code>## F1.S0001 F1.S0002 F1.S0003 F1.S0004 F1.S0005 F1.S0006 
## 2501.379 2502.944 2504.509 2506.074 2507.639 2509.204</code></pre>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="vrije-besteding-een-nieuwe-skill-ontwikkelen.html#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(<span class="fu">mz</span>(bpis[<span class="dv">1</span>, <span class="dv">1</span>]))</span></code></pre></div>
<pre class="watch-out"><code>## [1] 200 600</code></pre>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="vrije-besteding-een-nieuwe-skill-ontwikkelen.html#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(<span class="fu">intensity</span>(bpis[<span class="dv">1</span>, <span class="dv">1</span>]))</span></code></pre></div>
<pre class="watch-out"><code>## F1.S0001 F1.S0002 F1.S0003 F1.S0004 F1.S0005 F1.S0006 
##   145664   145664   145088   147392   152256   158592</code></pre>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="vrije-besteding-een-nieuwe-skill-ontwikkelen.html#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Verkrijg TICs:</span></span>
<span id="cb30-2"><a href="vrije-besteding-een-nieuwe-skill-ontwikkelen.html#cb30-2" aria-hidden="true" tabindex="-1"></a>bpis_2 <span class="ot">&lt;-</span> <span class="fu">chromatogram</span>(raw_data, <span class="at">aggregationFun =</span> <span class="st">&quot;sum&quot;</span>)</span>
<span id="cb30-3"><a href="vrije-besteding-een-nieuwe-skill-ontwikkelen.html#cb30-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-4"><a href="vrije-besteding-een-nieuwe-skill-ontwikkelen.html#cb30-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot chromatogrammen:</span></span>
<span id="cb30-5"><a href="vrije-besteding-een-nieuwe-skill-ontwikkelen.html#cb30-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(bpis, <span class="at">col =</span> group_colors[raw_data<span class="sc">$</span>sample_group], <span class="at">main =</span> <span class="st">&quot;BPC per sample: m/z ratio range: 200 - 600&quot;</span>)</span>
<span id="cb30-6"><a href="vrije-besteding-een-nieuwe-skill-ontwikkelen.html#cb30-6" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="dv">4100</span>, <span class="dv">1050000</span>, <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">&quot;wt&quot;</span>, <span class="st">&quot;ko&quot;</span>), <span class="at">lty =</span> <span class="dv">1</span>, <span class="at">col =</span> <span class="fu">c</span>(<span class="st">&quot;#60984EA3&quot;</span>, <span class="st">&quot;#604DAF4A&quot;</span>))</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-19-1.png" width="120%" /></p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="vrije-besteding-een-nieuwe-skill-ontwikkelen.html#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(bpis_2, <span class="at">col =</span> group_colors[raw_data<span class="sc">$</span>sample_group], <span class="at">main =</span> <span class="st">&quot;TIC per sample: m/z ratio range: 200 - 600&quot;</span>)</span>
<span id="cb31-2"><a href="vrije-besteding-een-nieuwe-skill-ontwikkelen.html#cb31-2" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="dv">4100</span>, <span class="dv">2250000</span>, <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">&quot;wt&quot;</span>, <span class="st">&quot;ko&quot;</span>), <span class="at">lty =</span> <span class="dv">1</span>, <span class="at">col =</span> <span class="fu">c</span>(<span class="st">&quot;#60984EA3&quot;</span>, <span class="st">&quot;#604DAF4A&quot;</span>))</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-19-2.png" width="120%" /></p>
<p>Net als in de vignette kijk ik naar de <em>ion current</em> verdeling per monster om een indruk te krijgen van de kwaliteit van de runs:</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="vrije-besteding-een-nieuwe-skill-ontwikkelen.html#cb32-1" aria-hidden="true" tabindex="-1"></a>tc <span class="ot">&lt;-</span> <span class="fu">split</span>(<span class="fu">tic</span>(raw_data), <span class="at">f =</span> <span class="fu">fromFile</span>(raw_data)) <span class="do">## file splitsen op total ion currents per monster</span></span>
<span id="cb32-2"><a href="vrije-besteding-een-nieuwe-skill-ontwikkelen.html#cb32-2" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(tc, <span class="at">col =</span> group_colors[raw_data<span class="sc">$</span>sample_group], <span class="at">main =</span> <span class="st">&quot;Total ion current per sample&quot;</span>, <span class="at">names =</span> <span class="fu">c</span>(<span class="st">&quot;wt18&quot;</span>, <span class="st">&quot;wt19&quot;</span>, <span class="st">&quot;ko18&quot;</span>, <span class="st">&quot;ko19&quot;</span>))</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-20-1.png" width="120%" />
De verdelingen zien eruit zoals in de vignette.</p>
<p>Vervolgens maak ik een <em>heatmap</em> om een overzicht te krijgen van hoe de monsters aan elkaar gerelateerd zijn. Net als in de vignette cluster ik de monsters samen gebaseerd op hun BPCs.</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="vrije-besteding-een-nieuwe-skill-ontwikkelen.html#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Groepeer intensiteiten in retentie tijd bins tegen variatie effect: </span></span>
<span id="cb33-2"><a href="vrije-besteding-een-nieuwe-skill-ontwikkelen.html#cb33-2" aria-hidden="true" tabindex="-1"></a>bpis_bin <span class="ot">&lt;-</span> MSnbase<span class="sc">::</span><span class="fu">bin</span>(bpis, <span class="at">binSize =</span> <span class="dv">2</span>)</span>
<span id="cb33-3"><a href="vrije-besteding-een-nieuwe-skill-ontwikkelen.html#cb33-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-4"><a href="vrije-besteding-een-nieuwe-skill-ontwikkelen.html#cb33-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Bereken de correlatie coëfficiënten gebaseerd op log2-genormaliseerde bins:</span></span>
<span id="cb33-5"><a href="vrije-besteding-een-nieuwe-skill-ontwikkelen.html#cb33-5" aria-hidden="true" tabindex="-1"></a>cormat <span class="ot">&lt;-</span> <span class="fu">cor</span>(<span class="fu">log2</span>(<span class="fu">do.call</span>(cbind, <span class="fu">lapply</span>(bpis_bin, intensity))))</span>
<span id="cb33-6"><a href="vrije-besteding-een-nieuwe-skill-ontwikkelen.html#cb33-6" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(cormat) <span class="ot">&lt;-</span> <span class="fu">rownames</span>(cormat) <span class="ot">&lt;-</span> raw_data<span class="sc">$</span>sample_name <span class="do">## zet monsters horizontaal en verticaal</span></span>
<span id="cb33-7"><a href="vrije-besteding-een-nieuwe-skill-ontwikkelen.html#cb33-7" aria-hidden="true" tabindex="-1"></a>cormat</span></code></pre></div>
<pre class="watch-out"><code>##           ko18      ko19      wt18      wt19
## ko18 1.0000000 0.9660005 0.9629162 0.9651172
## ko19 0.9660005 1.0000000 0.9437898 0.9815005
## wt18 0.9629162 0.9437898 1.0000000 0.9608660
## wt19 0.9651172 0.9815005 0.9608660 1.0000000</code></pre>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="vrije-besteding-een-nieuwe-skill-ontwikkelen.html#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Geef phenodata op voor annotatie in heatmap:</span></span>
<span id="cb35-2"><a href="vrije-besteding-een-nieuwe-skill-ontwikkelen.html#cb35-2" aria-hidden="true" tabindex="-1"></a>ann <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">group =</span> raw_data<span class="sc">$</span>sample_group)</span>
<span id="cb35-3"><a href="vrije-besteding-een-nieuwe-skill-ontwikkelen.html#cb35-3" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(ann) <span class="ot">&lt;-</span> raw_data<span class="sc">$</span>sample_name</span>
<span id="cb35-4"><a href="vrije-besteding-een-nieuwe-skill-ontwikkelen.html#cb35-4" aria-hidden="true" tabindex="-1"></a>ann</span></code></pre></div>
<pre class="watch-out"><code>##      group
## ko18    KO
## ko19    KO
## wt18    WT
## wt19    WT</code></pre>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="vrije-besteding-een-nieuwe-skill-ontwikkelen.html#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pheatmap</span>(cormat, <span class="at">annotation =</span> ann, <span class="at">annotation_color =</span> <span class="fu">list</span>(<span class="at">group =</span> group_colors))</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-21-1.png" width="120%" /></p>
<p>Er lijkt een vrij sterke correlatie te zijn tussen de KO en WT monsters met index 19. <em>Ik ben er niet achter gekomen wat deze indexen precies betekenen, iets met de methode/meetvolgorde</em>. Voor de monsters met index 18 lijkt dit niet het geval.</p>
</div>
<div id="piekdetectie" class="section level3 hasAnchor" number="6.3.3">
<h3><span class="header-section-number">6.3.3</span> 3) Piekdetectie<a href="vrije-besteding-een-nieuwe-skill-ontwikkelen.html#piekdetectie" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>De <em>peak detection</em> wordt uitgevoerd met het centWave algoritme. Daartoe bepaal ik eerst wat de ‘peakwidth’-waarde moet zijn, door het <em>extracted ion chromatogram</em> (EIC) van één piek te plotten. Een EIC laat het signaal zien van één geselecteerd ion oftewel één m/z ratio <span class="citation">(<span>“<span>LCMS</span> Data Preprocessing and Analysis with Xcms”</span> n.d.)</span>.</p>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="vrije-besteding-een-nieuwe-skill-ontwikkelen.html#cb38-1" aria-hidden="true" tabindex="-1"></a>rtr <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">2700</span>, <span class="dv">2900</span>)</span>
<span id="cb38-2"><a href="vrije-besteding-een-nieuwe-skill-ontwikkelen.html#cb38-2" aria-hidden="true" tabindex="-1"></a>mzr <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">334.9</span>, <span class="fl">335.1</span>) <span class="do">## zelfde als in vignette om de samples te kunnen vergelijken</span></span>
<span id="cb38-3"><a href="vrije-besteding-een-nieuwe-skill-ontwikkelen.html#cb38-3" aria-hidden="true" tabindex="-1"></a>chr_raw <span class="ot">&lt;-</span> <span class="fu">chromatogram</span>(raw_data, <span class="at">mz =</span> mzr, <span class="at">rt =</span> rtr)</span>
<span id="cb38-4"><a href="vrije-besteding-een-nieuwe-skill-ontwikkelen.html#cb38-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(chr_raw, <span class="at">col =</span> group_colors[chr_raw<span class="sc">$</span>sample_group], <span class="at">main =</span> <span class="st">&quot;m/z ratio range: 334.9 - 335.1&quot;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-22-1.png" width="120%" /></p>
<p>De piek is maximaal 80 seconden breedt. Net als in de vignette stel ik de ‘peakwidth’ in op ‘20, 80’, wat volgens mij de minimale en maximale piekbreedte moet voorstellen.</p>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="vrije-besteding-een-nieuwe-skill-ontwikkelen.html#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Voer peak detection uit op EIC: </span></span>
<span id="cb39-2"><a href="vrije-besteding-een-nieuwe-skill-ontwikkelen.html#cb39-2" aria-hidden="true" tabindex="-1"></a>cwp <span class="ot">&lt;-</span> <span class="fu">CentWaveParam</span>(<span class="at">peakwidth =</span> <span class="fu">c</span>(<span class="dv">20</span>, <span class="dv">80</span>), <span class="at">noise =</span> <span class="dv">5000</span>, <span class="at">prefilter =</span> <span class="fu">c</span>(<span class="dv">6</span>, <span class="dv">5000</span>)) <span class="co"># noise en prefilter om de analyse tijd te verlagen</span></span>
<span id="cb39-3"><a href="vrije-besteding-een-nieuwe-skill-ontwikkelen.html#cb39-3" aria-hidden="true" tabindex="-1"></a>xdata <span class="ot">&lt;-</span> <span class="fu">findChromPeaks</span>(raw_data, <span class="at">param =</span> cwp) </span>
<span id="cb39-4"><a href="vrije-besteding-een-nieuwe-skill-ontwikkelen.html#cb39-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-5"><a href="vrije-besteding-een-nieuwe-skill-ontwikkelen.html#cb39-5" aria-hidden="true" tabindex="-1"></a><span class="co"># De gevonden pieken per sample met informatie over m/z ratio&#39;s, retentie tijden en intensiteiten:</span></span>
<span id="cb39-6"><a href="vrije-besteding-een-nieuwe-skill-ontwikkelen.html#cb39-6" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(<span class="fu">chromPeaks</span>(xdata))</span></code></pre></div>
<pre class="watch-out"><code>##         mz mzmin mzmax       rt    rtmin    rtmax      into      intb   maxo sn
## CP0001 316   316   316 2517.029 2501.379 2535.808  741708.6  727319.6  27816 47
## CP0002 333   333   333 2515.464 2501.379 2540.503  960445.7  942106.5  33992 42
## CP0003 338   338   338 2517.029 2501.379 2540.503  788766.4  758962.1  29288 35
## CP0004 332   332   332 2517.029 2501.379 2545.198 4870388.0 4768520.5 169280 92
## CP0005 315   315   315 2515.464 2501.379 2540.503 3714288.6 3634444.9 131136 95
## CP0006 337   337   337 2517.029 2501.379 2549.893 4356732.5 4216751.1 142720 83
##        sample
## CP0001      1
## CP0002      1
## CP0003      1
## CP0004      1
## CP0005      1
## CP0006      1</code></pre>
<p>Met de ‘refineChromPeaks’ <em>function</em> kan de detectie worden verfijnd. Pieken die bijv. niet voldoen aan een bepaalde intensiteit worden verwijderd. Hieronder worden overlappende pieken samengevoegd <span class="citation">(<span>“<span>LCMS</span> Data Preprocessing and Analysis with Xcms”</span> n.d.)</span>.</p>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="vrije-besteding-een-nieuwe-skill-ontwikkelen.html#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="do">## de volgende codes zijn uitgezet met &#39;#&#39; omdat ze BiocParallel errors geven tijdens het builden:</span></span>
<span id="cb41-2"><a href="vrije-besteding-een-nieuwe-skill-ontwikkelen.html#cb41-2" aria-hidden="true" tabindex="-1"></a><span class="co">#mpp &lt;- MergeNeighboringPeaksParam(expandRt = 4) ## check voor overlap in een rt window van vier seconden rond pieken</span></span>
<span id="cb41-3"><a href="vrije-besteding-een-nieuwe-skill-ontwikkelen.html#cb41-3" aria-hidden="true" tabindex="-1"></a><span class="co">#xdata_pp &lt;- refineChromPeaks(xdata, mpp)</span></span></code></pre></div>
<p>De resultaten van de <em>peak detection</em> kunnen op verschillende manieren worden samengevat:</p>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="vrije-besteding-een-nieuwe-skill-ontwikkelen.html#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="co"># A) Overzicht van het aantal geïdentificeerde pieken per monster en hun breedtes: </span></span>
<span id="cb42-2"><a href="vrije-besteding-een-nieuwe-skill-ontwikkelen.html#cb42-2" aria-hidden="true" tabindex="-1"></a>summary_fun <span class="ot">&lt;-</span> <span class="cf">function</span>(z)</span>
<span id="cb42-3"><a href="vrije-besteding-een-nieuwe-skill-ontwikkelen.html#cb42-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">c</span>(<span class="at">peak_count =</span> <span class="fu">nrow</span>(z), <span class="at">rt =</span> <span class="fu">quantile</span>(z[, <span class="st">&quot;rtmax&quot;</span>] <span class="sc">-</span> z[, <span class="st">&quot;rtmin&quot;</span>])) <span class="do">## voor elk monster</span></span>
<span id="cb42-4"><a href="vrije-besteding-een-nieuwe-skill-ontwikkelen.html#cb42-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-5"><a href="vrije-besteding-een-nieuwe-skill-ontwikkelen.html#cb42-5" aria-hidden="true" tabindex="-1"></a>T <span class="ot">&lt;-</span> <span class="fu">lapply</span>(<span class="fu">split.data.frame</span>(</span>
<span id="cb42-6"><a href="vrije-besteding-een-nieuwe-skill-ontwikkelen.html#cb42-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">chromPeaks</span>(xdata_pp), <span class="at">f =</span> <span class="fu">chromPeaks</span>(xdata_pp)[, <span class="st">&quot;sample&quot;</span>]),</span>
<span id="cb42-7"><a href="vrije-besteding-een-nieuwe-skill-ontwikkelen.html#cb42-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">FUN =</span> summary_fun)</span>
<span id="cb42-8"><a href="vrije-besteding-een-nieuwe-skill-ontwikkelen.html#cb42-8" aria-hidden="true" tabindex="-1"></a>T</span></code></pre></div>
<pre class="watch-out"><code>## $`1`
## peak_count      rt.0%     rt.25%     rt.50%     rt.75%    rt.100% 
##    339.000     10.954     34.429     45.383     57.904    173.709 
## 
## $`2`
## peak_count      rt.0%     rt.25%     rt.50%     rt.75%    rt.100% 
##   247.0000    10.9540    40.6885    50.0790    64.1630   406.8880 
## 
## $`3`
## peak_count      rt.0%     rt.25%     rt.50%     rt.75%    rt.100% 
##    302.000      3.130     35.994     49.296     61.033    424.103 
## 
## $`4`
## peak_count      rt.0%     rt.25%     rt.50%     rt.75%    rt.100% 
##    238.000     10.954     39.124     50.078     62.598    593.118</code></pre>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="vrije-besteding-een-nieuwe-skill-ontwikkelen.html#cb44-1" aria-hidden="true" tabindex="-1"></a>T <span class="ot">&lt;-</span> <span class="fu">do.call</span>(rbind, T)</span>
<span id="cb44-2"><a href="vrije-besteding-een-nieuwe-skill-ontwikkelen.html#cb44-2" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(T) <span class="ot">&lt;-</span> <span class="fu">basename</span>(<span class="fu">fileNames</span>(xdata_pp))</span>
<span id="cb44-3"><a href="vrije-besteding-een-nieuwe-skill-ontwikkelen.html#cb44-3" aria-hidden="true" tabindex="-1"></a><span class="fu">kbl</span>(T, <span class="at">caption =</span> <span class="st">&quot;__Summary statistics on identified chromatographic peaks__. Shown are the number of identified peaks per sample and their widths/duration.&quot;</span>) <span class="sc">%&gt;%</span> <span class="fu">kable_styling</span>(<span class="at">full_width =</span> <span class="cn">FALSE</span>, <span class="at">bootstrap_options =</span> <span class="st">&quot;striped&quot;</span>, <span class="at">position =</span> <span class="st">&quot;left&quot;</span>, <span class="at">latex_options =</span> <span class="st">&quot;scale_down&quot;</span>) <span class="sc">%&gt;%</span> <span class="fu">column_spec</span>(<span class="dv">1</span>, <span class="at">bold =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<table class="table table-striped" style="width: auto !important; ">
<caption>
<span id="tab:unnamed-chunk-25">Table 6.3: </span><strong>Summary statistics on identified chromatographic peaks</strong>. Shown are the number of identified peaks per sample and their widths/duration.
</caption>
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:right;">
peak_count
</th>
<th style="text-align:right;">
rt.0%
</th>
<th style="text-align:right;">
rt.25%
</th>
<th style="text-align:right;">
rt.50%
</th>
<th style="text-align:right;">
rt.75%
</th>
<th style="text-align:right;">
rt.100%
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;font-weight: bold;">
ko18.CDF
</td>
<td style="text-align:right;">
339
</td>
<td style="text-align:right;">
10.954
</td>
<td style="text-align:right;">
34.4290
</td>
<td style="text-align:right;">
45.383
</td>
<td style="text-align:right;">
57.904
</td>
<td style="text-align:right;">
173.709
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;">
ko19.CDF
</td>
<td style="text-align:right;">
247
</td>
<td style="text-align:right;">
10.954
</td>
<td style="text-align:right;">
40.6885
</td>
<td style="text-align:right;">
50.079
</td>
<td style="text-align:right;">
64.163
</td>
<td style="text-align:right;">
406.888
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;">
wt18.CDF
</td>
<td style="text-align:right;">
302
</td>
<td style="text-align:right;">
3.130
</td>
<td style="text-align:right;">
35.9940
</td>
<td style="text-align:right;">
49.296
</td>
<td style="text-align:right;">
61.033
</td>
<td style="text-align:right;">
424.103
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;">
wt19.CDF
</td>
<td style="text-align:right;">
238
</td>
<td style="text-align:right;">
10.954
</td>
<td style="text-align:right;">
39.1240
</td>
<td style="text-align:right;">
50.078
</td>
<td style="text-align:right;">
62.598
</td>
<td style="text-align:right;">
593.118
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="vrije-besteding-een-nieuwe-skill-ontwikkelen.html#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="co"># B) Per monster de &#39;locatie&#39; van pieken in de m/z ratio - retentie tijd dimensie:</span></span>
<span id="cb45-2"><a href="vrije-besteding-een-nieuwe-skill-ontwikkelen.html#cb45-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plotChromPeaks</span>(xdata_pp, <span class="at">file =</span> <span class="dv">1</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-26-1.png" width="120%" /></p>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="vrije-besteding-een-nieuwe-skill-ontwikkelen.html#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plotChromPeaks</span>(xdata_pp, <span class="at">file =</span> <span class="dv">3</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-26-2.png" width="120%" /></p>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="vrije-besteding-een-nieuwe-skill-ontwikkelen.html#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="co"># C) Piekdichtheid, oftewel het aantal pieken, over de retentie tijd:</span></span>
<span id="cb47-2"><a href="vrije-besteding-een-nieuwe-skill-ontwikkelen.html#cb47-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plotChromPeakImage</span>(xdata_pp) <span class="do">## lichter van kleur = hogere dichtheid</span></span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-26-3.png" width="120%" /></p>
<p><em>Intermezzo: ontleding van samenvattende tabel</em><br>
‘split.data.frame(chromPeaks(xdata_pp), f = chromPeaks(xdata_pp)[, “sample”])’ maakt één <em>list</em> van per monster één <em>vector</em> met de geïdentificeerde pieken. Met ‘lapply()’ wordt op elke <em>vector</em> in deze <em>list</em> de ‘summary_fun’ <em>function</em> uitgevoerd, die het aantal pieken en de quantielen van de retentie tijd verdeling teruggeeft. Deze worden opgeslagen als <em>list</em> ‘T’ en ‘do.call()’ roept vervolgens de <em>function</em> ‘rbind’ aan, die de pieken en quantielen combineert in een array. De rijnamen worden vervangen en er wordt een tabel gemaakt.</p>
<p>Ik controleer net als in de vignette de piekdetectie met de piek die hierboven is gebruikt om de ‘peakwidth’ te bepalen:</p>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb48-1"><a href="vrije-besteding-een-nieuwe-skill-ontwikkelen.html#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Nogmaals de voorbeeldpiek:</span></span>
<span id="cb48-2"><a href="vrije-besteding-een-nieuwe-skill-ontwikkelen.html#cb48-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(chr_raw, <span class="at">col =</span> group_colors[chr_raw<span class="sc">$</span>sample_group], <span class="at">main =</span> <span class="st">&quot;m/z ratio range: 334.9 - 335.1&quot;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-27-1.png" width="120%" /></p>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="vrije-besteding-een-nieuwe-skill-ontwikkelen.html#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Maak het EIC opnieuw, ditmaal bevat het ook de geïdentificeerde pieken van het ion:</span></span>
<span id="cb49-2"><a href="vrije-besteding-een-nieuwe-skill-ontwikkelen.html#cb49-2" aria-hidden="true" tabindex="-1"></a>chr_ex <span class="ot">&lt;-</span> <span class="fu">chromatogram</span>(xdata_pp, <span class="at">mz =</span> mzr, <span class="at">rt =</span> rtr)</span>
<span id="cb49-3"><a href="vrije-besteding-een-nieuwe-skill-ontwikkelen.html#cb49-3" aria-hidden="true" tabindex="-1"></a>sample_colors <span class="ot">&lt;-</span> group_colors[chr_ex<span class="sc">$</span>sample_group]</span>
<span id="cb49-4"><a href="vrije-besteding-een-nieuwe-skill-ontwikkelen.html#cb49-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(chr_ex, <span class="at">col =</span> group_colors[chr_raw<span class="sc">$</span>sample_group], <span class="at">lwd =</span> <span class="dv">2</span>, <span class="at">peakBg =</span> sample_colors[<span class="fu">chromPeaks</span>(chr_ex)[, <span class="st">&quot;sample&quot;</span>]], <span class="at">main =</span> <span class="st">&quot;m/z ratio range: 334.9 - 335.1&quot;</span>) <span class="do">## highlight de geïdentificeerde pieken</span></span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-27-2.png" width="120%" /></p>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb50-1"><a href="vrije-besteding-een-nieuwe-skill-ontwikkelen.html#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Verkrijg info over de pieken in deze regio:</span></span>
<span id="cb50-2"><a href="vrije-besteding-een-nieuwe-skill-ontwikkelen.html#cb50-2" aria-hidden="true" tabindex="-1"></a><span class="fu">kbl</span>(<span class="fu">chromPeaks</span>(xdata_pp, <span class="at">mz =</span> mzr, <span class="at">rt =</span> rtr), <span class="at">caption =</span> <span class="st">&quot;__Identified chromatographic peaks in a selected m/z and retention time range__.&quot;</span>) <span class="sc">%&gt;%</span> <span class="fu">kable_styling</span>(<span class="at">full_width =</span> <span class="cn">FALSE</span>, <span class="at">bootstrap_options =</span> <span class="st">&quot;striped&quot;</span>, <span class="at">position =</span> <span class="st">&quot;left&quot;</span>, <span class="at">latex_options =</span> <span class="st">&quot;scale_down&quot;</span>) <span class="sc">%&gt;%</span> <span class="fu">column_spec</span>(<span class="dv">1</span>, <span class="at">bold =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<table class="table table-striped" style="width: auto !important; ">
<caption>
<span id="tab:unnamed-chunk-27">Table 6.4: </span><strong>Identified chromatographic peaks in a selected m/z and retention time range</strong>.
</caption>
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:right;">
mz
</th>
<th style="text-align:right;">
mzmin
</th>
<th style="text-align:right;">
mzmax
</th>
<th style="text-align:right;">
rt
</th>
<th style="text-align:right;">
rtmin
</th>
<th style="text-align:right;">
rtmax
</th>
<th style="text-align:right;">
into
</th>
<th style="text-align:right;">
intb
</th>
<th style="text-align:right;">
maxo
</th>
<th style="text-align:right;">
sn
</th>
<th style="text-align:right;">
sample
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;font-weight: bold;">
CP0041
</td>
<td style="text-align:right;">
335
</td>
<td style="text-align:right;">
335
</td>
<td style="text-align:right;">
335
</td>
<td style="text-align:right;">
2786.201
</td>
<td style="text-align:right;">
2764.291
</td>
<td style="text-align:right;">
2812.805
</td>
<td style="text-align:right;">
211297.2
</td>
<td style="text-align:right;">
194283.0
</td>
<td style="text-align:right;">
8158
</td>
<td style="text-align:right;">
15
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;">
CP0403
</td>
<td style="text-align:right;">
335
</td>
<td style="text-align:right;">
335
</td>
<td style="text-align:right;">
335
</td>
<td style="text-align:right;">
2783.069
</td>
<td style="text-align:right;">
2762.725
</td>
<td style="text-align:right;">
2812.804
</td>
<td style="text-align:right;">
285228.1
</td>
<td style="text-align:right;">
264248.6
</td>
<td style="text-align:right;">
9154
</td>
<td style="text-align:right;">
18
</td>
<td style="text-align:right;">
2
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;">
CP0718
</td>
<td style="text-align:right;">
335
</td>
<td style="text-align:right;">
335
</td>
<td style="text-align:right;">
335
</td>
<td style="text-align:right;">
2787.765
</td>
<td style="text-align:right;">
2765.855
</td>
<td style="text-align:right;">
2820.629
</td>
<td style="text-align:right;">
1636669.0
</td>
<td style="text-align:right;">
1603950.7
</td>
<td style="text-align:right;">
54640
</td>
<td style="text-align:right;">
78
</td>
<td style="text-align:right;">
3
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;">
CP1060
</td>
<td style="text-align:right;">
335
</td>
<td style="text-align:right;">
335
</td>
<td style="text-align:right;">
335
</td>
<td style="text-align:right;">
2784.635
</td>
<td style="text-align:right;">
2759.595
</td>
<td style="text-align:right;">
2809.674
</td>
<td style="text-align:right;">
643673.2
</td>
<td style="text-align:right;">
631119.1
</td>
<td style="text-align:right;">
20672
</td>
<td style="text-align:right;">
54
</td>
<td style="text-align:right;">
4
</td>
</tr>
</tbody>
</table>
<p>Ik rond de piekdetectie af door te kijken naar de distributie van piek intensiteit per monster. Hiermee controleren ik volgens de vignette of er geen stelselmatige verschillen zijn tussen de runs van de monsters <span class="citation">(<span>“<span>LCMS</span> Data Preprocessing and Analysis with Xcms”</span> n.d.)</span>.</p>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="vrije-besteding-een-nieuwe-skill-ontwikkelen.html#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Verkrijg piek intensiteiten per monster op een log2-schaal:</span></span>
<span id="cb51-2"><a href="vrije-besteding-een-nieuwe-skill-ontwikkelen.html#cb51-2" aria-hidden="true" tabindex="-1"></a>ints <span class="ot">&lt;-</span> <span class="fu">split</span>(<span class="fu">log2</span>(<span class="fu">chromPeaks</span>(xdata_pp)[, <span class="st">&quot;into&quot;</span>]),</span>
<span id="cb51-3"><a href="vrije-besteding-een-nieuwe-skill-ontwikkelen.html#cb51-3" aria-hidden="true" tabindex="-1"></a>              <span class="at">f =</span> <span class="fu">chromPeaks</span>(xdata_pp)[, <span class="st">&quot;sample&quot;</span>])</span>
<span id="cb51-4"><a href="vrije-besteding-een-nieuwe-skill-ontwikkelen.html#cb51-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-5"><a href="vrije-besteding-een-nieuwe-skill-ontwikkelen.html#cb51-5" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(ints, <span class="at">varwidth =</span> <span class="cn">TRUE</span>, <span class="at">col =</span> group_colors[xdata_pp<span class="sc">$</span>sample_group],</span>
<span id="cb51-6"><a href="vrije-besteding-een-nieuwe-skill-ontwikkelen.html#cb51-6" aria-hidden="true" tabindex="-1"></a>        <span class="at">ylab =</span> <span class="fu">expression</span>(log[<span class="dv">2</span>]<span class="sc">~</span>intensity), <span class="at">main =</span> <span class="st">&quot;Peak intensities per sample&quot;</span>, <span class="at">names =</span> <span class="fu">c</span>(<span class="st">&quot;wt18&quot;</span>, <span class="st">&quot;wt19&quot;</span>, <span class="st">&quot;ko18&quot;</span>, <span class="st">&quot;ko19&quot;</span>))</span>
<span id="cb51-7"><a href="vrije-besteding-een-nieuwe-skill-ontwikkelen.html#cb51-7" aria-hidden="true" tabindex="-1"></a><span class="fu">grid</span>(<span class="at">nx =</span> <span class="cn">NA</span>, <span class="at">ny =</span> <span class="cn">NULL</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-28-1.png" width="120%" /></p>
</div>
<div id="alignment" class="section level3 hasAnchor" number="6.3.4">
<h3><span class="header-section-number">6.3.4</span> 4) <em>Alignment</em><a href="vrije-besteding-een-nieuwe-skill-ontwikkelen.html#alignment" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>De retentie tijd van eenzelfde ion kan variëren tussen monsters (zie EIC voorbeeldpiek). Ik corrigeer hiervoor met de ‘adjustRtime’ <em>function</em>, die de pieken langs de retentie tijd as verschuift om ze te <em>alignen</em>. Hieronder wordt de obiwarp methode gebruikt die de retentie tijden van de spectra <em>alignt</em>, beter bekend als <em>warping</em> <span class="citation">(<span>“<span>LCMS</span> Data Preprocessing and Analysis with Xcms”</span> n.d.)</span>.</p>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb52-1"><a href="vrije-besteding-een-nieuwe-skill-ontwikkelen.html#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Align:</span></span>
<span id="cb52-2"><a href="vrije-besteding-een-nieuwe-skill-ontwikkelen.html#cb52-2" aria-hidden="true" tabindex="-1"></a>xdata_adj <span class="ot">&lt;-</span> <span class="fu">adjustRtime</span>(xdata_pp, <span class="at">param =</span> <span class="fu">ObiwarpParam</span>(<span class="at">binSize =</span> <span class="fl">0.6</span>))</span>
<span id="cb52-3"><a href="vrije-besteding-een-nieuwe-skill-ontwikkelen.html#cb52-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-4"><a href="vrije-besteding-een-nieuwe-skill-ontwikkelen.html#cb52-4" aria-hidden="true" tabindex="-1"></a><span class="co">#Vergelijk retentie tijden:</span></span>
<span id="cb52-5"><a href="vrije-besteding-een-nieuwe-skill-ontwikkelen.html#cb52-5" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(<span class="fu">rtime</span>(xdata_adj, <span class="at">adjusted =</span> <span class="cn">FALSE</span>))</span></code></pre></div>
<pre class="watch-out"><code>## F1.S0001 F1.S0002 F1.S0003 F1.S0004 F1.S0005 F1.S0006 
## 2501.379 2502.944 2504.509 2506.074 2507.639 2509.204</code></pre>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb54-1"><a href="vrije-besteding-een-nieuwe-skill-ontwikkelen.html#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(<span class="fu">rtime</span>(xdata_adj))</span></code></pre></div>
<pre class="watch-out"><code>## F1.S0001 F1.S0002 F1.S0003 F1.S0004 F1.S0005 F1.S0006 
## 2501.378 2502.971 2504.564 2506.156 2507.748 2509.340</code></pre>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb56-1"><a href="vrije-besteding-een-nieuwe-skill-ontwikkelen.html#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="co"># BPCs vóór alignment:</span></span>
<span id="cb56-2"><a href="vrije-besteding-een-nieuwe-skill-ontwikkelen.html#cb56-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(bpis, <span class="at">col =</span> group_colors[raw_data<span class="sc">$</span>sample_group], <span class="at">main =</span> <span class="st">&quot;BPC per sample: m/z ratio range: 200 - 600&quot;</span>)</span>
<span id="cb56-3"><a href="vrije-besteding-een-nieuwe-skill-ontwikkelen.html#cb56-3" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="dv">4100</span>, <span class="dv">1050000</span>, <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">&quot;wt&quot;</span>, <span class="st">&quot;ko&quot;</span>), <span class="at">lty =</span> <span class="dv">1</span>, <span class="at">col =</span> <span class="fu">c</span>(<span class="st">&quot;#60984EA3&quot;</span>, <span class="st">&quot;#604DAF4A&quot;</span>))</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-29-1.png" width="120%" /></p>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb57-1"><a href="vrije-besteding-een-nieuwe-skill-ontwikkelen.html#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="co"># BPCs ná alignment:</span></span>
<span id="cb57-2"><a href="vrije-besteding-een-nieuwe-skill-ontwikkelen.html#cb57-2" aria-hidden="true" tabindex="-1"></a><span class="do">## de volgende function geeft in deze context BiocParallel errors tijdens het builden:</span></span>
<span id="cb57-3"><a href="vrije-besteding-een-nieuwe-skill-ontwikkelen.html#cb57-3" aria-hidden="true" tabindex="-1"></a><span class="co">#bpis_adj &lt;- chromatogram(xdata_adj, aggregationFun = &quot;max&quot;, include = &quot;none&quot;)</span></span>
<span id="cb57-4"><a href="vrije-besteding-een-nieuwe-skill-ontwikkelen.html#cb57-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-5"><a href="vrije-besteding-een-nieuwe-skill-ontwikkelen.html#cb57-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(bpis_adj, <span class="at">col =</span> group_colors[bpis_adj<span class="sc">$</span>sample_group], <span class="at">main =</span> <span class="st">&quot;BPC per sample after alignment: m/z ratio range: 200 - 600&quot;</span>)</span>
<span id="cb57-6"><a href="vrije-besteding-een-nieuwe-skill-ontwikkelen.html#cb57-6" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="dv">4100</span>, <span class="dv">1050000</span>, <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">&quot;wt&quot;</span>, <span class="st">&quot;ko&quot;</span>), <span class="at">lty =</span> <span class="dv">1</span>, <span class="at">col =</span> <span class="fu">c</span>(<span class="st">&quot;#60984EA3&quot;</span>, <span class="st">&quot;#604DAF4A&quot;</span>))</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-29-2.png" width="120%" /></p>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb58-1"><a href="vrije-besteding-een-nieuwe-skill-ontwikkelen.html#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot ook het verschil tussen de ruwe en aangepaste retentie tijden:</span></span>
<span id="cb58-2"><a href="vrije-besteding-een-nieuwe-skill-ontwikkelen.html#cb58-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plotAdjustedRtime</span>(xdata_adj, <span class="at">col =</span> group_colors[xdata_adj<span class="sc">$</span>sample_group])</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-29-3.png" width="120%" /></p>
<p>Het effect van de <em>alignment</em> is goed zichtbaar op de voorbeeldpiek:</p>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb59-1"><a href="vrije-besteding-een-nieuwe-skill-ontwikkelen.html#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Nogmaals de ruwe EIC voorbeeldpiek:</span></span>
<span id="cb59-2"><a href="vrije-besteding-een-nieuwe-skill-ontwikkelen.html#cb59-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(chr_raw, <span class="at">col =</span> group_colors[chr_raw<span class="sc">$</span>sample_group], <span class="at">main =</span> <span class="st">&quot;m/z ratio range: 334.9 - 335.1&quot;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-30-1.png" width="120%" /></p>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb60-1"><a href="vrije-besteding-een-nieuwe-skill-ontwikkelen.html#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Verkrijg het EIC van de voorbeeldpiek na retentie tijd correctie:</span></span>
<span id="cb60-2"><a href="vrije-besteding-een-nieuwe-skill-ontwikkelen.html#cb60-2" aria-hidden="true" tabindex="-1"></a>chr_adj <span class="ot">&lt;-</span> <span class="fu">chromatogram</span>(xdata_adj, <span class="at">rt =</span> rtr, <span class="at">mz =</span> mzr)</span>
<span id="cb60-3"><a href="vrije-besteding-een-nieuwe-skill-ontwikkelen.html#cb60-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(chr_adj, <span class="at">col =</span> group_colors[chr_raw<span class="sc">$</span>sample_group], <span class="at">peakType =</span> <span class="st">&quot;none&quot;</span>, <span class="at">main =</span> <span class="st">&quot;m/z ratio range: 334.9 - 335.1&quot;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-30-2.png" width="120%" /></p>
</div>
<div id="correspondence" class="section level3 hasAnchor" number="6.3.5">
<h3><span class="header-section-number">6.3.5</span> 5) <em>Correspondence</em><a href="vrije-besteding-een-nieuwe-skill-ontwikkelen.html#correspondence" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>De laatste <em>preprocessing</em>-stap is het identificeren van dezelfde pieken in de monsters: de <em>correspondence analysis</em>. Daartoe worden de pieken eerst per kleine m/z ratio-intervallen gegroepeerd in <em>features</em> op basis van
de piekdichtheid over de retenie tijd. Hieronder een voorbeeld voor het m/z ratio interval 305.05 - 305.15 <span class="citation">(<span>“<span>LCMS</span> Data Preprocessing and Analysis with Xcms”</span> n.d.)</span>.</p>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb61-1"><a href="vrije-besteding-een-nieuwe-skill-ontwikkelen.html#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Defineer interval:</span></span>
<span id="cb61-2"><a href="vrije-besteding-een-nieuwe-skill-ontwikkelen.html#cb61-2" aria-hidden="true" tabindex="-1"></a>mzr <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">305.05</span>, <span class="fl">305.15</span>)</span>
<span id="cb61-3"><a href="vrije-besteding-een-nieuwe-skill-ontwikkelen.html#cb61-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-4"><a href="vrije-besteding-een-nieuwe-skill-ontwikkelen.html#cb61-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Verkrijg bijbehorend EIC:</span></span>
<span id="cb61-5"><a href="vrije-besteding-een-nieuwe-skill-ontwikkelen.html#cb61-5" aria-hidden="true" tabindex="-1"></a><span class="do">## deze function geeft BiocParallel errors tijdens het builden:</span></span>
<span id="cb61-6"><a href="vrije-besteding-een-nieuwe-skill-ontwikkelen.html#cb61-6" aria-hidden="true" tabindex="-1"></a><span class="co">#chr_mzr &lt;- chromatogram(xdata_adj, mz = mzr)</span></span>
<span id="cb61-7"><a href="vrije-besteding-een-nieuwe-skill-ontwikkelen.html#cb61-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-8"><a href="vrije-besteding-een-nieuwe-skill-ontwikkelen.html#cb61-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Groepeer pieken:</span></span>
<span id="cb61-9"><a href="vrije-besteding-een-nieuwe-skill-ontwikkelen.html#cb61-9" aria-hidden="true" tabindex="-1"></a>pdp <span class="ot">&lt;-</span> <span class="fu">PeakDensityParam</span>(<span class="at">sampleGroups =</span> xdata_adj<span class="sc">$</span>sample_group, <span class="at">minFraction =</span> <span class="fl">0.4</span>, <span class="at">bw =</span> <span class="dv">30</span>) <span class="do">## &#39;minFraction = 0.4&#39; geeft aan dat alleen pieken gegroepeerd worden die in minstens 40% van de monsters voorkomen, &#39;bw = 30&#39; geeft de SD van de Kernel lijnsmoothing methode</span></span>
<span id="cb61-10"><a href="vrije-besteding-een-nieuwe-skill-ontwikkelen.html#cb61-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-11"><a href="vrije-besteding-een-nieuwe-skill-ontwikkelen.html#cb61-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot resultaat:</span></span>
<span id="cb61-12"><a href="vrije-besteding-een-nieuwe-skill-ontwikkelen.html#cb61-12" aria-hidden="true" tabindex="-1"></a><span class="fu">plotChromPeakDensity</span>(chr_mzr, <span class="at">col =</span> sample_colors, <span class="at">param =</span> pdp, <span class="at">peakBg =</span> sample_colors[<span class="fu">chromPeaks</span>(chr_mzr)[, <span class="st">&quot;sample&quot;</span>]], <span class="at">peakCol =</span> sample_colors[<span class="fu">chromPeaks</span>(chr_mzr)[, <span class="st">&quot;sample&quot;</span>]], <span class="at">peakPch =</span> <span class="dv">16</span>, <span class="at">main =</span> <span class="st">&quot;m/z ratio range: 305.05 - 305.15&quot;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-31-1.png" width="120%" /></p>
<p>Het bovenste paneel highlight de pieken in de EICs van de monsters. Het onderste paneel laat zien welke monsters (y-as) bij een bepaalde retentie tijd een piek lieten zien. Zo laten alle vier de monsters een piek zijn bij retentie tijden van ~ 2900 en 3500 seconden.</p>
<p>Ik definieer nu volgens de vignette de <em>features</em> van de gehele dataset en voer hier de <em>correspondence analysis</em> op uit met de ‘groupChromPeaks’ <em>function</em>:</p>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb62-1"><a href="vrije-besteding-een-nieuwe-skill-ontwikkelen.html#cb62-1" aria-hidden="true" tabindex="-1"></a>pdp <span class="ot">&lt;-</span> <span class="fu">PeakDensityParam</span>(<span class="at">sampleGroups =</span> xdata_adj<span class="sc">$</span>sample_group, <span class="at">minFraction =</span> <span class="fl">0.4</span>, <span class="at">bw =</span> <span class="dv">30</span>)</span>
<span id="cb62-2"><a href="vrije-besteding-een-nieuwe-skill-ontwikkelen.html#cb62-2" aria-hidden="true" tabindex="-1"></a>xdata_cor <span class="ot">&lt;-</span> <span class="fu">groupChromPeaks</span>(xdata_adj, <span class="at">param =</span> pdp)</span></code></pre></div>
<p>De resultaten van de <em>preprocessing</em> worden met de ‘quantify’ <em>function</em> samengevat tot een ‘SummarizedExperiment’ <em>object</em>:</p>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb63-1"><a href="vrije-besteding-een-nieuwe-skill-ontwikkelen.html#cb63-1" aria-hidden="true" tabindex="-1"></a>res <span class="ot">&lt;-</span> <span class="fu">quantify</span>(xdata_cor)</span>
<span id="cb63-2"><a href="vrije-besteding-een-nieuwe-skill-ontwikkelen.html#cb63-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-3"><a href="vrije-besteding-een-nieuwe-skill-ontwikkelen.html#cb63-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Informatie over de monsters:</span></span>
<span id="cb63-4"><a href="vrije-besteding-een-nieuwe-skill-ontwikkelen.html#cb63-4" aria-hidden="true" tabindex="-1"></a><span class="fu">colData</span>(res)</span></code></pre></div>
<pre class="watch-out"><code>## DataFrame with 4 rows and 2 columns
##          sample_name sample_group
##          &lt;character&gt;  &lt;character&gt;
## ko18.CDF        ko18           KO
## ko19.CDF        ko19           KO
## wt18.CDF        wt18           WT
## wt19.CDF        wt19           WT</code></pre>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb65-1"><a href="vrije-besteding-een-nieuwe-skill-ontwikkelen.html#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Informatie over de features: </span></span>
<span id="cb65-2"><a href="vrije-besteding-een-nieuwe-skill-ontwikkelen.html#cb65-2" aria-hidden="true" tabindex="-1"></a><span class="fu">featureDefinitions</span>(xdata_cor)</span></code></pre></div>
<pre class="watch-out"><code>## DataFrame with 466 rows and 11 columns
##           mzmed     mzmin     mzmax     rtmed     rtmin     rtmax    npeaks
##       &lt;numeric&gt; &lt;numeric&gt; &lt;numeric&gt; &lt;numeric&gt; &lt;numeric&gt; &lt;numeric&gt; &lt;numeric&gt;
## FT001    205.00     205.0     205.0   2786.11   2783.61   2788.05         4
## FT002    206.00     206.0     206.0   2785.11   2784.97   2787.60         3
## FT003    207.10     207.1     207.1   2712.81   2711.68   2713.95         2
## FT004    233.05     233.0     233.1   3017.70   3012.26   3023.14         2
## FT005    241.10     241.1     241.1   3678.22   3672.32   3688.44         3
## ...         ...       ...       ...       ...       ...       ...       ...
## FT462    594.20     594.2     594.2   3392.98   3392.98   3392.98         1
## FT463    594.35     594.3     594.4   3615.25   3613.90   3616.60         2
## FT464    595.20     595.2     595.2   2999.10   2999.10   2999.10         1
## FT465    596.35     596.3     596.4   3811.98   3808.11   3816.29         4
## FT466    597.40     597.4     597.4   3813.65   3813.65   3813.65         1
##              KO        WT         peakidx  ms_level
##       &lt;numeric&gt; &lt;numeric&gt;          &lt;list&gt; &lt;integer&gt;
## FT001         2         2  43,366,637,...         1
## FT002         1         2      30,620,912         1
## FT003         1         1          19,604         1
## FT004         1         0           67,71         1
## FT005         2         1   258, 518,1085         1
## ...         ...       ...             ...       ...
## FT462         0         1             716         1
## FT463         1         1         218,780         1
## FT464         0         1             654         1
## FT465         2         2 281,550,830,...         1
## FT466         0         1             831         1</code></pre>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb67-1"><a href="vrije-besteding-een-nieuwe-skill-ontwikkelen.html#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Per monster per feature de som van de intensiteiten van de feature pieken:</span></span>
<span id="cb67-2"><a href="vrije-besteding-een-nieuwe-skill-ontwikkelen.html#cb67-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(<span class="fu">featureValues</span>(xdata_cor))</span></code></pre></div>
<pre class="watch-out"><code>##        ko18.CDF  ko19.CDF  wt18.CDF  wt19.CDF
## FT001 1714581.8 1220358.1 1810112.3 1507943.1
## FT002  194603.7        NA  228501.1  216393.1
## FT003  337473.3        NA  182162.0        NA
## FT004  209999.6        NA        NA        NA
## FT005 1345515.1  608016.5        NA  621437.9
## FT006        NA        NA        NA  214367.8</code></pre>
<p>Indien er voor een monster geen pieken van een bepaalde <em>feature</em> zijn gevonden, zien we ‘NA’.</p>
<p>Missende intensiteiten worden ingevuld gebaseerd op de intensiteit van het <em>feature</em> in de andere monsters. De m/z ratio interval - retentie tijd regio van een <em>feature</em> wordt daartoe bepaald met de ‘ChromPeakAreaParam()’ <em>function</em>: de onderste grenzen van m/z ratio en retentie tijd zijn gelijk aan de 25% quantielen van respectievelijk de laagste m/z ratio (‘mzmin’) en de laagste retentie tijd (‘rtmin’) van alle pieken. De bovenste grenzen zijn gelijk aan de 75% quantielen van de hoogste m/z ratio (‘mzmax’) en de hoogste retentie tijd (‘rtmax’) <span class="citation">(<span>“<span>LCMS</span> Data Preprocessing and Analysis with Xcms”</span> n.d.)</span>.</p>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb69-1"><a href="vrije-besteding-een-nieuwe-skill-ontwikkelen.html#cb69-1" aria-hidden="true" tabindex="-1"></a>xdata_fill <span class="ot">&lt;-</span> <span class="fu">fillChromPeaks</span>(xdata_cor, <span class="at">param =</span> <span class="fu">ChromPeakAreaParam</span>())</span>
<span id="cb69-2"><a href="vrije-besteding-een-nieuwe-skill-ontwikkelen.html#cb69-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(<span class="fu">featureValues</span>(xdata_fill))</span></code></pre></div>
<pre class="watch-out"><code>##        ko18.CDF   ko19.CDF  wt18.CDF  wt19.CDF
## FT001 1714581.8 1220358.09 1810112.3 1507943.1
## FT002  194603.7  148572.79  228501.1  216393.1
## FT003  337473.3  102700.34  182162.0  165815.6
## FT004  209999.6  269525.70  278783.0  178828.5
## FT005 1345515.1  608016.51  743080.2  621437.9
## FT006        NA   34687.66        NA  214367.8</code></pre>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb71-1"><a href="vrije-besteding-een-nieuwe-skill-ontwikkelen.html#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="co"># NA&#39;s vóór invullen:</span></span>
<span id="cb71-2"><a href="vrije-besteding-een-nieuwe-skill-ontwikkelen.html#cb71-2" aria-hidden="true" tabindex="-1"></a><span class="fu">apply</span>(<span class="fu">featureValues</span>(xdata_fill, <span class="at">filled =</span> <span class="cn">FALSE</span>), <span class="at">MARGIN =</span> <span class="dv">2</span>, </span>
<span id="cb71-3"><a href="vrije-besteding-een-nieuwe-skill-ontwikkelen.html#cb71-3" aria-hidden="true" tabindex="-1"></a>      <span class="at">FUN =</span> <span class="cf">function</span>(z) <span class="fu">sum</span>(<span class="fu">is.na</span>(z))) <span class="co"># &#39;MARGIN = 2&#39; geeft aan dat de functie wordt toegepast op de kolommen van &#39;xdata_fill&#39;</span></span></code></pre></div>
<pre class="watch-out"><code>## ko18.CDF ko19.CDF wt18.CDF wt19.CDF 
##      140      226      182      239</code></pre>
<div class="sourceCode" id="cb73"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb73-1"><a href="vrije-besteding-een-nieuwe-skill-ontwikkelen.html#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="co"># NA&#39;s ná invullen:</span></span>
<span id="cb73-2"><a href="vrije-besteding-een-nieuwe-skill-ontwikkelen.html#cb73-2" aria-hidden="true" tabindex="-1"></a><span class="fu">apply</span>(<span class="fu">featureValues</span>(xdata_fill), <span class="at">MARGIN =</span> <span class="dv">2</span>,</span>
<span id="cb73-3"><a href="vrije-besteding-een-nieuwe-skill-ontwikkelen.html#cb73-3" aria-hidden="true" tabindex="-1"></a>      <span class="at">FUN =</span> <span class="cf">function</span>(z) <span class="fu">sum</span>(<span class="fu">is.na</span>(z)))</span></code></pre></div>
<pre class="watch-out"><code>## ko18.CDF ko19.CDF wt18.CDF wt19.CDF 
##       22       28       26       40</code></pre>
<p>Als volgt gebruik ik de ‘featureSummary’ <em>function</em> voor een algemene samenvatting per <em>feature</em>. ‘count’ en ‘perc’ geven het aantal monsters aan waarin een <em>feature</em> is gevonden. ‘multi_count’ en ‘multi_perc’ geven het aantal monsters aan waarin meer dan één piek uit een <em>feature</em> is teruggevonden. Het ‘group’ argument verdeelt deze statistieken verder over <em>knock-out</em> en wildtype monsters <span class="citation">(<span>“<span>LCMS</span> Data Preprocessing and Analysis with Xcms”</span> n.d.)</span>.</p>
<div class="sourceCode" id="cb75"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb75-1"><a href="vrije-besteding-een-nieuwe-skill-ontwikkelen.html#cb75-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(<span class="fu">featureSummary</span>(xdata_fill, <span class="at">group =</span> xdata_fill<span class="sc">$</span>sample_group))</span></code></pre></div>
<pre class="watch-out"><code>##       count perc multi_count multi_perc        rsd KO_count KO_perc
## FT001     4  100           0          0 0.16700614        2     100
## FT002     3   75           0          0 0.08058298        1      50
## FT003     2   50           0          0 0.42268744        1      50
## FT004     1   25           1        100         NA        1      50
## FT005     3   75           0          0 0.49162595        2     100
## FT006     1   25           0          0         NA        0       0
##       KO_multi_count KO_multi_perc    KO_rsd WT_count WT_perc WT_multi_count
## FT001              0             0 0.2381438        2     100              0
## FT002              0             0        NA        2     100              0
## FT003              0             0        NA        1      50              0
## FT004              1           100        NA        0       0              0
## FT005              0             0 0.5338948        1      50              0
## FT006              0             0        NA        1      50              0
##       WT_multi_perc     WT_rsd
## FT001             0 0.12878983
## FT002             0 0.03848858
## FT003             0         NA
## FT004             0         NA
## FT005             0         NA
## FT006             0         NA</code></pre>
<div class="sourceCode" id="cb77"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb77-1"><a href="vrije-besteding-een-nieuwe-skill-ontwikkelen.html#cb77-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Voeg de samenvatting met ingevulde pieken toe aan &#39;res&#39;:</span></span>
<span id="cb77-2"><a href="vrije-besteding-een-nieuwe-skill-ontwikkelen.html#cb77-2" aria-hidden="true" tabindex="-1"></a><span class="fu">assays</span>(res)<span class="sc">$</span>raw_filled <span class="ot">&lt;-</span> <span class="fu">featureValues</span>(xdata_fill, <span class="at">filled =</span> <span class="cn">TRUE</span>)</span>
<span id="cb77-3"><a href="vrije-besteding-een-nieuwe-skill-ontwikkelen.html#cb77-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(<span class="fu">assay</span>(res, <span class="st">&quot;raw&quot;</span>))</span></code></pre></div>
<pre class="watch-out"><code>##        ko18.CDF  ko19.CDF  wt18.CDF  wt19.CDF
## FT001 1714581.8 1220358.1 1810112.3 1507943.1
## FT002  194603.7        NA  228501.1  216393.1
## FT003  337473.3        NA  182162.0        NA
## FT004  209999.6        NA        NA        NA
## FT005 1345515.1  608016.5        NA  621437.9
## FT006        NA        NA        NA  214367.8</code></pre>
<div class="sourceCode" id="cb79"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb79-1"><a href="vrije-besteding-een-nieuwe-skill-ontwikkelen.html#cb79-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(<span class="fu">assay</span>(res, <span class="st">&quot;raw_filled&quot;</span>))</span></code></pre></div>
<pre class="watch-out"><code>##        ko18.CDF   ko19.CDF  wt18.CDF  wt19.CDF
## FT001 1714581.8 1220358.09 1810112.3 1507943.1
## FT002  194603.7  148572.79  228501.1  216393.1
## FT003  337473.3  102700.34  182162.0  165815.6
## FT004  209999.6  269525.70  278783.0  178828.5
## FT005 1345515.1  608016.51  743080.2  621437.9
## FT006        NA   34687.66        NA  214367.8</code></pre>
<p>Met de ‘featureChromatograms’ <em>function</em> kan voor elke <em>feature</em> een EIC gemaakt worden <span class="citation">(<span>“<span>LCMS</span> Data Preprocessing and Analysis with Xcms”</span> n.d.)</span>. Er zijn in totaal 268 <em>features</em> (‘nrow(featureValues(xdata_fill, filled = TRUE))’), ik laat de pieken van de eerste vier zien:</p>
<div class="sourceCode" id="cb81"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb81-1"><a href="vrije-besteding-een-nieuwe-skill-ontwikkelen.html#cb81-1" aria-hidden="true" tabindex="-1"></a>feature_chroms <span class="ot">&lt;-</span> <span class="fu">featureChromatograms</span>(xdata_fill, <span class="at">features =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>)</span>
<span id="cb81-2"><a href="vrije-besteding-een-nieuwe-skill-ontwikkelen.html#cb81-2" aria-hidden="true" tabindex="-1"></a><span class="co"># EIC informatie eerste vier features:</span></span>
<span id="cb81-3"><a href="vrije-besteding-een-nieuwe-skill-ontwikkelen.html#cb81-3" aria-hidden="true" tabindex="-1"></a><span class="fu">chromPeaks</span>(feature_chroms[<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>, ])</span></code></pre></div>
<pre class="watch-out"><code>##           mz mzmin mzmax       rt    rtmin    rtmax      into      intb  maxo
## CP0053 205.0 205.0 205.0 2788.052 2766.480 2818.842 1714581.8 1643169.4 63800
## CP0407 205.0 205.0 205.0 2786.199 2762.725 2817.498 1220358.1 1164812.1 39104
## CP0719 205.0 205.0 205.0 2783.610 2762.676 2813.673 1810112.3 1740802.4 63200
## CP1063 205.0 205.0 205.0 2786.022 2763.892 2820.934 1507943.1 1445439.2 49144
## CP0035 206.0 206.0 206.0 2784.971 2768.022 2815.764  194603.7  182508.9  8483
## CP0701 206.0 206.0 206.0 2785.107 2764.170 2812.162  228501.1  212686.2  8450
## CP1051 206.0 206.0 206.0 2787.605 2762.315 2814.578  216393.1  202836.7  7652
## CP0020 207.1 207.1 207.1 2713.948 2701.542 2743.337  337473.3  335177.5 14035
## CP0682 207.1 207.1 207.1 2711.681 2693.470 2725.244  182162.0  165026.9 10354
## CP0078 233.1 233.1 233.1 3012.260 2998.279 3043.347  209999.6  196015.1 21048
## CP0082 233.0 233.0 233.0 3023.137 2964.127 3066.682  364299.5  313862.2 21352
##        sn sample row column
## CP0053 37      1   1      1
## CP0407 33      2   1      2
## CP0719 42      3   1      3
## CP1063 40      4   1      4
## CP0035 17      1   2      1
## CP0701 12      3   2      3
## CP1051 19      4   2      4
## CP0020 47      1   3      1
## CP0682 13      3   3      3
## CP0078 14      1   4      1
## CP0082 24      1   4      1</code></pre>
<div class="sourceCode" id="cb83"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb83-1"><a href="vrije-besteding-een-nieuwe-skill-ontwikkelen.html#cb83-1" aria-hidden="true" tabindex="-1"></a><span class="co"># EICs:</span></span>
<span id="cb83-2"><a href="vrije-besteding-een-nieuwe-skill-ontwikkelen.html#cb83-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(feature_chroms, <span class="at">col =</span> sample_colors, <span class="at">peakBg =</span> sample_colors[<span class="fu">chromPeaks</span>(feature_chroms)[, <span class="st">&quot;sample&quot;</span>]])</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-36-1.png" width="120%" /></p>
<p>Ik rond de analyse af met een <em>principal component analysis</em>, waarmee wordt bepaald hoe de monsters in dit experiment zich tot elkaar verhouden. <em>Er is geen data normalisatie stap beschikbaar binnen het {xcms} package</em>.</p>
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb84-1"><a href="vrije-besteding-een-nieuwe-skill-ontwikkelen.html#cb84-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Log2-transformeer de features:</span></span>
<span id="cb84-2"><a href="vrije-besteding-een-nieuwe-skill-ontwikkelen.html#cb84-2" aria-hidden="true" tabindex="-1"></a>ft_ints <span class="ot">&lt;-</span> <span class="fu">log2</span>(<span class="fu">assay</span>(res, <span class="st">&quot;raw_filled&quot;</span>))</span>
<span id="cb84-3"><a href="vrije-besteding-een-nieuwe-skill-ontwikkelen.html#cb84-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-4"><a href="vrije-besteding-een-nieuwe-skill-ontwikkelen.html#cb84-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Voer de PCA uit:</span></span>
<span id="cb84-5"><a href="vrije-besteding-een-nieuwe-skill-ontwikkelen.html#cb84-5" aria-hidden="true" tabindex="-1"></a>pc <span class="ot">&lt;-</span> <span class="fu">prcomp</span>(<span class="fu">t</span>(<span class="fu">na.omit</span>(ft_ints)), <span class="at">center =</span> <span class="cn">TRUE</span>) <span class="do">## negeer missende waarden met &#39;na.omit()&#39; en trek de gemiddelde intensiteit van alle intensiteiten af met &#39;center = TRUE&#39;</span></span>
<span id="cb84-6"><a href="vrije-besteding-een-nieuwe-skill-ontwikkelen.html#cb84-6" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(pc)</span></code></pre></div>
<pre class="watch-out"><code>## Importance of components:
##                            PC1     PC2    PC3       PC4
## Standard deviation     15.3020 13.8276 7.5980 2.388e-14
## Proportion of Variance  0.4847  0.3958 0.1195 0.000e+00
## Cumulative Proportion   0.4847  0.8805 1.0000 1.000e+00</code></pre>
<div class="sourceCode" id="cb86"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb86-1"><a href="vrije-besteding-een-nieuwe-skill-ontwikkelen.html#cb86-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot de PCA resultaten:</span></span>
<span id="cb86-2"><a href="vrije-besteding-een-nieuwe-skill-ontwikkelen.html#cb86-2" aria-hidden="true" tabindex="-1"></a>cols <span class="ot">&lt;-</span> group_colors[xdata_fill<span class="sc">$</span>sample_group]</span>
<span id="cb86-3"><a href="vrije-besteding-een-nieuwe-skill-ontwikkelen.html#cb86-3" aria-hidden="true" tabindex="-1"></a>pcSummary <span class="ot">&lt;-</span> <span class="fu">summary</span>(pc)</span>
<span id="cb86-4"><a href="vrije-besteding-een-nieuwe-skill-ontwikkelen.html#cb86-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(pc<span class="sc">$</span>x[, <span class="dv">1</span>], pc<span class="sc">$</span>x[,<span class="dv">2</span>], <span class="at">pch =</span> <span class="dv">21</span>, <span class="at">main =</span> <span class="st">&quot;&quot;</span>,</span>
<span id="cb86-5"><a href="vrije-besteding-een-nieuwe-skill-ontwikkelen.html#cb86-5" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="fu">paste0</span>(<span class="st">&quot;PC1: &quot;</span>, <span class="fu">format</span>(pcSummary<span class="sc">$</span>importance[<span class="dv">2</span>, <span class="dv">1</span>] <span class="sc">*</span> <span class="dv">100</span>,</span>
<span id="cb86-6"><a href="vrije-besteding-een-nieuwe-skill-ontwikkelen.html#cb86-6" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">digits =</span> <span class="dv">3</span>), <span class="st">&quot; % variance&quot;</span>),</span>
<span id="cb86-7"><a href="vrije-besteding-een-nieuwe-skill-ontwikkelen.html#cb86-7" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="fu">paste0</span>(<span class="st">&quot;PC2: &quot;</span>, <span class="fu">format</span>(pcSummary<span class="sc">$</span>importance[<span class="dv">2</span>, <span class="dv">2</span>] <span class="sc">*</span> <span class="dv">100</span>,</span>
<span id="cb86-8"><a href="vrije-besteding-een-nieuwe-skill-ontwikkelen.html#cb86-8" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">digits =</span> <span class="dv">3</span>), <span class="st">&quot; % variance&quot;</span>),</span>
<span id="cb86-9"><a href="vrije-besteding-een-nieuwe-skill-ontwikkelen.html#cb86-9" aria-hidden="true" tabindex="-1"></a>     <span class="at">col =</span> <span class="st">&quot;darkgrey&quot;</span>, <span class="at">bg =</span> cols, <span class="at">cex =</span> <span class="dv">2</span>)</span>
<span id="cb86-10"><a href="vrije-besteding-een-nieuwe-skill-ontwikkelen.html#cb86-10" aria-hidden="true" tabindex="-1"></a><span class="fu">grid</span>()</span>
<span id="cb86-11"><a href="vrije-besteding-een-nieuwe-skill-ontwikkelen.html#cb86-11" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(pc<span class="sc">$</span>x[, <span class="dv">1</span>], pc<span class="sc">$</span>x[,<span class="dv">2</span>], <span class="at">labels =</span> xdata_fill<span class="sc">$</span>sample_name, <span class="at">col =</span> <span class="st">&quot;darkgrey&quot;</span>,</span>
<span id="cb86-12"><a href="vrije-besteding-een-nieuwe-skill-ontwikkelen.html#cb86-12" aria-hidden="true" tabindex="-1"></a>     <span class="at">pos =</span> <span class="fu">c</span>(<span class="dv">4</span>, <span class="dv">3</span>, <span class="dv">1</span>, <span class="dv">2</span>), <span class="at">cex =</span> <span class="dv">1</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-37-1.png" width="120%" />
<strong>Conclusie</strong><br>
Volgens PC1, wat 48,5% van de variatie omvat, is er een duidelijk verschil tussen de monsters gebaseerd op aanwezigheid van het werkzame FAAH gen. Volgens PC2, met 39,6% variatie ook een aanzienlijk signaal, worden de monsters ook verdeeld gebaseerd op hun index. Omdat er niet van te voren genormaliseerd is, zou dit verschil veroorzaakt kunnen worden door een afwijking in de methode. Bijvoorbeeld: de dag waarop is gemeten heeft het resultaat beïnvloedt <span class="citation">(<span>“<span>LCMS</span> Data Preprocessing and Analysis with Xcms”</span> n.d.)</span>.</p>
</div>
</div>
<div id="afronding" class="section level2 hasAnchor" number="6.4">
<h2><span class="header-section-number">6.4</span> Afronding<a href="vrije-besteding-een-nieuwe-skill-ontwikkelen.html#afronding" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Wat hebben de afgelopen 32 uur mij gebracht? Het meest heb ik opgestoken van de hindernissen die ik tegenkwam tijdens de installatie van nieuwe R <em>packages.</em> Van een verouderde RTools versie tot missende <em>function</em> beschrijvingen en errors in een <em>package</em> zelf. Ik vind het waardevol om alle stappen, van het bedenken wat voor een <em>package</em> je nodig hebt tot je eigen analyse schrijven, doorlopen te hebben. Daarnaast heb ik geleerd wat voor <em>preprocessing</em> stappen er nodig zijn om van ruwe MS data te komen tot een vergelijking van samenstellingen tussen monsters. Ik verwacht niet dat mijn ervaring met het {xcms} <em>package</em> mij direct gaat helpen tijdens mijn stage of werk; wanneer ik met een massaspectrometer ga werken verwacht ik dat de metingen geanalyseerd worden in een speciaal programma dat geen aanvulling nodig heeft van een dergelijk <em>package</em>. Desalniettemin verwacht ik wél dat ik nu beter kan inschatten en begrijpen wat er achter de schermen van zo’n programma allemaal moet gebeuren. Daarnaast zou ik met behulp van dit <em>package</em> mijn ruwe data en gebruikte analyse wel openbaar kunnen maken, waarmee ik anderen kan helpen of om hulp en feedback kan vragen. De komende tijd zal ik verder werken aan mijn <em>skill</em> door te oefenen met andere R <em>packages</em>, zoals {ptw}. Ik hoop daarmee mijn algemene begrip van MS data, <em>preprocessing</em> en analyses te vergroten. Op school zijn een aantal mooie massaspectrometers aanwezig. Ik heb al een keer een introductie van een docent gekregen op een UPLC-MS en zal ook zeker om een vervolg vragen. Daarbij zal ik Chemie docenten en studenten vragen hoe zij de MS data precies analyseren en me gaan verdiepen in de door hun gebruikte programma’s. Ik weet zeker dat ik daarmee goed voorbereid ben op mijn droomstage en een bedrijf zelfs kan helpen in de richting van een betere analyse <em>workflow</em>.</p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="vaardigheid-4-opmaken-met-rmarkdown-en-html-syntax.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="vaardigheid-5-correct-refereren-m.b.v.-een-reference-manager.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
